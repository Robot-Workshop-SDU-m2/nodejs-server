<!doctype html>
<html>

<head>
  <title>Socket.IO chat</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,body {
      width: 100%;
      height: 100%;
      font: 13px Helvetica, Arial;
    }

    form {
      background: #ccc;
      padding: 3px;
    }

    form input {
      border: 0;
      padding: 10px;
      margin-right: .5%;
    }

    form button {
      width: 9%;
      background: rgb(130, 224, 255);
      border: none;
      padding: 10px;
    }

    #renderCanvas {
      width: 20%;
      height: 500px;
      touch-action: none;
    }
  </style>

</head>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script src="https://cdn.babylonjs.com/babylon.js"></script>
<script src="https://code.jquery.com/pep/0.4.1/pep.js"></script>
<script>
  $(function () {
    var socket = io();
    $('form').submit(function () {
      socket.emit('chat message', "G0;" + $('#x').val() + ";" + $('#y').val() + ";" + $('#z').val() + ";");
      $('#m').val('');
      return false;
    });
    /*socket.on('chat message', function(msg){
      $('#messages').append($('<li>').text(msg));
    });*/
  });
</script>

<body>
  <canvas id="renderCanvas" touch-action="none"></canvas>
  <script>

    var canvas = document.getElementById("renderCanvas"); // Get the canvas element 

    var engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine


    /******* Add the create scene function ******/
    var createScene = function () {

      // Create the scene space
      var scene = new BABYLON.Scene(engine);

      // Add a camera to the scene and attach it to the canvas
      var camera = new BABYLON.ArcRotateCamera("Camera", Math.PI / 2, Math.PI / 2, 80, new BABYLON.Vector3(0,20,0), scene);
      camera.attachControl(canvas, true);

      // Add lights to the scene
      var light1 = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(1, 1, 0), scene);
      var light2 = new BABYLON.PointLight("light2", new BABYLON.Vector3(0, 1, -1), scene);


      // Add and manipulate meshes in the scene

      //AXES
      var xAxis = BABYLON.MeshBuilder.CreateCylinder("xAxis", { diameter: .5, height: 40 }, scene);
      var yAxis = BABYLON.MeshBuilder.CreateCylinder("yAxis", { diameter: .5, height: 40 }, scene);
      var zAxis = BABYLON.MeshBuilder.CreateCylinder("zAxis", { diameter: .5, height: 40 }, scene);
      xAxis.position = new BABYLON.Vector3(0, 20, 10);
      yAxis.position = new BABYLON.Vector3(8.66, 20, -5);
      zAxis.position = new BABYLON.Vector3(-8.66, 20, -5);
      //JOINTS
      var xCarr = BABYLON.MeshBuilder.CreateSphere("xCarr", { diameter: 1 }, scene);
      var yCarr = BABYLON.MeshBuilder.CreateSphere("yCarr", { diameter: 1 }, scene);
      var zCarr = BABYLON.MeshBuilder.CreateSphere("zCarr", { diameter: 1 }, scene);
      xCarr.position = new BABYLON.Vector3(0, 11.22, 10);
      yCarr.position = new BABYLON.Vector3(8.66, 17.29, -5);
      zCarr.position = new BABYLON.Vector3(-8.66, 14.36, -5);
      var TCP = BABYLON.MeshBuilder.CreateSphere("TCP", { diameter: 1 }, scene);
      TCP.position = new BABYLON.Vector3(2, 4, -3);
      //ARMS
      //var xArm = BABYLON.MeshBuilder.CreateCylinder("xArm", { diameter: .5, height: 15 }, scene);
      //var yArm = BABYLON.MeshBuilder.CreateCylinder("yArm", { diameter: .5, height: 15 }, scene);
      //var zArm = BABYLON.MeshBuilder.CreateCylinder("zArm", { diameter: .5, height: 15 }, scene);
      //xArm.position = new BABYLON.Vector3(0, 0, 5);
      //yArm.position = new BABYLON.Vector3(4, 0, -2.6);
      //zArm.position = new BABYLON.Vector3(-4, 0, -2.6);
      var xLine = [ xCarr.position, TCP.position ];
      var yLine = [ yCarr.position, TCP.position ];
      var zLine = [ zCarr.position, TCP.position ];

      var xArm = BABYLON.MeshBuilder.CreateLines("lines", {points: xLine}, scene);
      var yArm = BABYLON.MeshBuilder.CreateLines("lines", {points: yLine}, scene);
      var zArm = BABYLON.MeshBuilder.CreateLines("lines", {points: zLine}, scene);

      scene.registerAfterRender(function(){
        
      });

      var advancedTexture = BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI");

      var slider = BABYLON.GUI.Crea

      return scene;
    };

    /******* End of the create scene function ******/

    var scene = createScene(); //Call the createScene function

    engine.runRenderLoop(function () { // Register a render loop to repeatedly render the scene
      scene.render();
    });


    window.addEventListener("resize", function () { // Watch for browser/canvas resize events
      engine.resize();
    });
  </script>
  <form action="">
    X:
    <input id="x" type="number" step="100" value="0" /> Y:
    <input id="y" type="number" step="500" value="0" /> Z:
    <input id="z" type="number" step="500" value="0" />
    <button>Send</button>
  </form>

</body>

</html>